{
  "$jason": {
    "head": {
      "title": "Giffy - By Customer PIN Code",
      "description": "This app enable consumer to buy and use digital gift card powered by Giffy",
      "actions": {
        "$load": {
          "type": "$set",
          "options": {
            "dynamic_pin2": "",
            "mobile_number2": "",
            "expiry2": "",
            "expiry": ""
          },
          "success": {
            "type": "$render"
          }
        },
        "$foreground": {
          "type": "$reload"
        }
      },
      "templates": {
        "body": {
          "background": "#f3f3f3",
          "header": {
            "title": {
            "type": "image",
            "url": "{{$global.jason_url}}/giffy_circle_small.png"
            },
            "style": {
              "background": "#BC845C"
            },
            "menu": {
              "text": "SHARE",
              "style": {
                "color": "#FFFFFF"
              },
              "action": {
                "type": "$util.share",
                "options": {
                  "items": [{
                    "type": "text",
                    "text": "Please enter PIN: {{$get.dynamic_pin2}} by {{$get.expiry}} to proceed."
                  }]
                }
              }
            }
          },
          "sections": [{
            "items": [{
              "type": "vertical",
              "style": {
                "align": "center",
                "padding": "20",
                "distribution": "equalspacing"
              },
              "components": [{
                "type": "space",
                "style": {
                "height": "20"
                }
              },{
                "type": "label",
                "text": "Your Dynamic PIN:",
                "style": {
                  "size": "18"
                }
              },{
                "type": "space",
                "style": {
                "height": "20"
                }
              },{
                "type": "label",
                "text": "{{$get.dynamic_pin2}}",
                "style": {
                  "size": "24"
                }
              },{
                "type": "label",
                "text": "{{$get.expiry2}}",
                "style": {
                  "size": "12"
                }
              },{
                "type": "space",
                "style": {
                  "height": "20"
                }
              },{
                "type": "button",
                "text": "Get PIN",
                "style": {
                  "background": "#d9d9d9",
                  "color": "#000000",
                  "height": "80",
                  "size": "24"
                },
                "action": {
                  "type": "$network.request",
                  "options": {
                    "url": "{{$global.jason_url}}/merchgencode.json",
                    "method": "get",
                    "header" : {
                      "Authorization": "Bearer {{$global.jwt_token}}",
                      "content_type": "json"
                    },
                    "data": {
                      "card_id": "{{$params.card_id}}"
                    }
                  },
                  "success": {
                    "type": "$set",
                    "options": {
                      "dynamic_pin2": "{{$jason.dynamic_pin}}",
                      "expiry": "{{$jason.expiry}}",
                      "expiry2": "Expired by: {{$jason.expiry}}"
                    },
                    "success": {
                      "type": "$render"
                    }
                  },
                  "error": {
                    "type": "$util.toast",
                    "options": {
                      "text": "Unable to generate dynamic PIN. Please check your internet connection.",
                      "type": "warning"
                    }
                  }
                }
              },{
                "type": "horizontal",
                "components": [{
                  "type": "label",
                  "text": "Merchant PIN Mode",
                  "style": {
                    "size": "18"
                  }
                },{
                  "type": "switch",
                  "name": "bymerchpincode",
                  "value": "false",
                  "action": {
                    "type": "$href",
                    "url": "{{$global.jason_url}}/consumerapp_bymerchpincode.json",
                    "options": {
                      "card_id": "{{$params.card_id}}"
                    }
                  }
                }]
              }]
            }]
          }],
          "footer": {
            "tabs": {
              "style": {
                "background": "#BC845C",
                "color:disabled": "#FFFFFF",
                "color": "#84522D"
              },
              "items": [{
                "text": "HISTORY",
                "style": {
                  "height": "21"
                },
                "href": {
                  "url": "{{$global.jason_url}}/consumerapp_cardtranshistory.json",
                  "transition": "replace",
                  "options": {
                    "card_id": "{{$params.card_id}}"
                  }
                }
              }, {
                "text": "QR CODE",
                "style": {
                  "height": "21"
                },
                "href": {
                  "url": "{{$global.jason_url}}/consumerapp_byqrcode.json",
                  "transition": "replace",
                  "options": {
                    "card_id": "{{$params.card_id}}"
                  }
                }
              }, {
                "text": "PIN CODE",
                "style": {
                  "height": "21"
                },
                "href": {
                  "url": "{{$global.jason_url}}/consumerapp_bycustpincode.json",
                  "transition": "replace",
                  "options": {
                    "card_id": "{{$params.card_id}}"
                  }
                }
              }]
            }
          }
        }
      }
    }
  }
}
